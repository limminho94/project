#include <iostream>
#include <cstring>
#include <sys/socket.h>
#include <arpa/inet.h>
#include <algorithm>
#include <unistd.h>
#include <limits> // numeric_limits ì‚¬ìš©ì„ ìœ„í•´ ì¶”ê°€
#include <set>
#include <string>
#include <sstream>
#include <map>
#include <vector>
#include <regex>

using namespace std;

#define RED "\033[31m"
#define RED_BOLD "\033[1;31m"
#define ORANGE "\033[38;5;214m"
#define ORANGE_BOLD "\033[1;38;5;214m"
#define YELLOW "\033[33m"
#define YELLOW_BOLD "\033[1;33m"
#define GREEN "\033[32m"
#define GREEN_BOLD "\033[1;32m"
#define BLUE "\033[34m"
#define BLUE_BOLD "\033[1;34m"
#define PURPLE "\033[35m"
#define PURPLE_BOLD "\033[1;35m"
#define PINK "\033[38;5;213m"
#define PINK_BOLD "\033[1;38;5;213m"
#define BROWN "\033[38;5;130m"
#define BROWN_BOLD "\033[1;38;5;130m"
#define LBLUE "\033[38;5;153m" // ì—°í•œ íŒŒë€ìƒ‰
#define LBLUE_BOLD "\033[1;38;5;153m"
#define LGREEN "\033[38;5;154m"          // ì—°í•œ ì´ˆë¡ìƒ‰
#define LGREEN_BOLD "\033[1;38;5;154m"   // ì—°í•œ ì´ˆë¡ìƒ‰
#define CHARCOAL "\033[38;5;240m"        // ì°¨ì½œìƒ‰ (ì–´ë‘ìš´ íšŒìƒ‰)
#define CHARCOAL_BOLD "\033[1;38;5;240m" // ì°¨ì½œìƒ‰ (êµµì€ ìŠ¤íƒ€ì¼)
#define END "\033[0m"

// ì¹´ë“œ í˜œíƒ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” êµ¬ì¡°ì²´
struct CardBenefit
{
    string cardName;
    string benefitType;
    int benefitValue;
};

// ì„±í–¥ ì ìˆ˜ êµ¬ì¡°ì²´
struct BenefitScore
{
    string benefitType;
    int score;
};

// ì„±í–¥ ì ìˆ˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ëŠ” í•¨ìˆ˜
bool compareScores(BenefitScore a, BenefitScore b)
{
    return a.score > b.score;
}

// í˜œíƒ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ëŠ” í•¨ìˆ˜
bool compareBenefits(CardBenefit a, CardBenefit b)
{
    return a.benefitValue > b.benefitValue;
}

// ì˜¬ë°”ë¥¸ ì…ë ¥ì„ ë°›ì„ ë•Œê¹Œì§€ ë°˜ë³µí•˜ëŠ” í•¨ìˆ˜
int getValidInput()
{
    int input;
    while (true)
    {
        cin >> input;
        if (input == 1 || input == 2)
        {
            break; // ì…ë ¥ê°’ì´ 1 ë˜ëŠ” 2ì¸ ê²½ìš° ë£¨í”„ íƒˆì¶œ
        }
        else
        {
            cout << "ì˜ëª»ëœ ì…ë ¥ì…ë‹ˆë‹¤. ë‹¤ì‹œ ì…ë ¥í•˜ì„¸ìš”     (1. YES  2. NO): ";
            continue;
        }
    }
    return input;
}

constexpr int BUF_SIZE = 1024;
const char *SERVER_IP = "127.0.0.1";

class Card
{
private:
    int idx = 0;
    std::string name;           // ì¹´ë“œëª…
    std::string company;        // ì¹´ë“œì‚¬
    std::string annualFee;      // ì—°íšŒë¹„
    std::string preMonSpending; // ì „ì›” ì‹¤ì 
    std::string benetype1;      // í˜œíƒ1 íƒ€ì…
    std::string bene1;          // í˜œíƒ1 ìƒì„¸
    std::string benetype2;      // í˜œíƒ2 íƒ€ì…
    std::string bene2;          // í˜œíƒ2 ìƒì„¸

    map<string, string> benefits;

public:
    // ìƒì„±ì
    Card(const std::string &name, const std::string &company, const std::string &annualFee,
         const std::string &previousMonthSpending, const std::string &benetype1, const std::string &bene1, const std::string &benetype2, const std::string &bene2)
        : name(name), company(company), annualFee(annualFee),
          preMonSpending(previousMonthSpending), benetype1(benetype1), bene1(bene1), benetype2(benetype2), bene2(bene2)
    {
        idx++;
        benefits = {
            {"ëŒ€ì¤‘êµí†µ", "ğŸšŒ êµí†µ"},
            {"ì‡¼í•‘", "ğŸ›ï¸  ì‡¼í•‘"},
            {"ì™¸ì‹", "ğŸ½ï¸  ì™¸ì‹"},
            {"ì˜ë£Œ", "ğŸ¥ ì˜ë£Œ"},
            {"ì£¼ìœ ", "â›½ ì£¼ìœ "},
            {"í†µì‹ ", "ğŸ“ í†µì‹ "}};
        // ğŸ
    }

    // ì ‘ê·¼ ë©”ì„œë“œ
    std::string getName() const { return name; }
    std::string getCompany() const { return company; }
    std::string getAnnualFee() const { return annualFee; }
    std::string getPreviousMonthSpending() const { return preMonSpending; }

    // í…ìŠ¤íŠ¸ ëŒ€ì¹˜ í•¨ìˆ˜ ì„ ì–¸ ë° ì •ì˜
    string replaceBenefits(const string &inputText) const
    {
        string result = inputText;

        // ë°˜ë³µë¬¸ì„ ì´ìš©í•´ mapì˜ ëª¨ë“  í‚¤ì›Œë“œì™€ ê·¸ì— ëŒ€ì‘í•˜ëŠ” ì´ëª¨ì§€ë¥¼ ëŒ€ì¹˜
        for (const auto &pair : benefits)
        {
            // í‚¤ì›Œë“œë¥¼ ì •ê·œ í‘œí˜„ì‹ìœ¼ë¡œ ì‚¬ìš©í•˜ì—¬ ì „ì²´ ë¬¸ìì—´ì—ì„œ ëŒ€ì²´
            regex pattern(pair.first);
            result = regex_replace(result, pattern, pair.second);
        }

        return result;
    }

    // í•„í„°ë§ ë©”ì„œë“œ: ì‚¬ìš©ìê°€ ì„ íƒí•œ í˜œíƒê³¼ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸
    bool isBenefitMatch(const std::vector<std::string> &userBenefits) const
    {
        return std::find(userBenefits.begin(), userBenefits.end(), benetype1) != userBenefits.end() ||
               std::find(userBenefits.begin(), userBenefits.end(), benetype2) != userBenefits.end();
    }

    // ì¹´ë“œ ì •ë³´ ì¶œë ¥ í•¨ìˆ˜
    void printCardInfo() const
    {
        std::string cmp_temp;
        // std::cout << "-----------------------------------------------------------------------------------------------\n";

        std::cout << "ã€€" << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“ \n";
        std::cout << "ã€€" << "â”ƒ   " << PURPLE_BOLD << name << END << "                                     \n";
        // ì¹´ë“œì‚¬ì˜ ì´ë¦„ì— ë”°ë¼ ì¶œë ¥ ìƒ‰ìƒ ì„¤ì • (ì¤‘ë³µ ì½”ë“œ ê°„ì†Œí™”)
        if (company == "KBêµ­ë¯¼ì¹´ë“œ")
        {
            cmp_temp = "êµ­ë¯¼ì¹´ë“œ";
            std::cout << "ã€€" << "â”ƒ                                  " << ORANGE_BOLD << cmp_temp << END << "          â”ƒ\n";
        }
        else if (company == "ì‹ í•œì¹´ë“œ" || company == "í•˜ë‚˜ì¹´ë“œ")
            std::cout << "ã€€" << "â”ƒ                                  " << GREEN_BOLD << company << END << "          â”ƒ\n";
        else if (company == "ë¡¯ë°ì¹´ë“œ")
            std::cout << "ã€€" << "â”ƒ                                  " << RED_BOLD << company << END << "          â”ƒ\n";
        else if (company == "ì‚¼ì„±ì¹´ë“œ" || company == "ìš°ë¦¬ì¹´ë“œ")
            std::cout << "ã€€" << "â”ƒ                                  " << BLUE_BOLD << company << END << "          â”ƒ\n";
        std::cout << "ã€€" << "â”ƒ                                                    â”ƒ\n";
        std::cout << "ã€€" << "â”ƒ    â– â– â– â– â– â–                                           â”ƒ\n";
        std::cout << "ã€€" << "â”ƒ    â– â– â– â– â– â–                                           â”ƒ\n";
        std::cout << "ã€€" << "â”ƒ                                                    â”ƒ\n";
        std::cout << "ã€€" << "â”ƒ           0000  0000  1234  1234  1234             â”ƒ\n";
        std::cout << "ã€€" << "â”ƒ                                                    â”ƒ\n";
        std::cout << "ã€€" << "â”ƒ                                                    â”ƒ\n";
        std::cout << "ã€€" << "â”ƒ                              year  11/28           â”ƒ\n";
        std::cout << "ã€€" << "â”ƒ                                                    â”ƒ\n";
        std::cout << "ã€€" << "â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”› \n";

        // std::cout << PURPLE_BOLD << "ã€€" << name << END << '\t';
        // í˜œíƒ ì •ë³´ë¥¼ ì´ëª¨ì§€ë¡œ ëŒ€ì²´
        string replacedBene1 = replaceBenefits(benetype1);
        string replacedBene2 = replaceBenefits(benetype2);

        std::cout << BROWN_BOLD
                  << "   " << replacedBene1
                  << "    " << bene1 << '\n'
                  << "   " << replacedBene2
                  << "    " << bene2 << END << '\n'
                  << LGREEN_BOLD << "   ì—°íšŒë¹„     "
                  << annualFee << END << '\n'
                  << LBLUE_BOLD << "   ì „ì›”ì‹¤ì    "
                  << preMonSpending << END << "\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n"
                  << std::endl;
    }
};

// ë¬¸ìì—´ì„ êµ¬ë¶„ìë¡œ ë¶„ë¦¬í•˜ëŠ” í•¨ìˆ˜
std::vector<std::string> split(const std::string &str, char delimiter)
{
    std::vector<std::string> tokens;
    std::stringstream ss(str);
    std::string token;
    while (std::getline(ss, token, delimiter))
    {
        tokens.push_back(token);
    }
    return tokens;
}

int main()
{
    // í¬íŠ¸ ì…ë ¥ ë°›ê¸°
    int port;
    std::cout << "ì—°ê²°í•  ì„œë²„ í¬íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”: ";
    std::cin >> port;

    // ìœ íš¨ì„± ê²€ì‚¬
    if (std::cin.fail() || port <= 0 || port > 65535)
    {
        std::cerr << "ìœ íš¨í•˜ì§€ ì•Šì€ í¬íŠ¸ ë²ˆí˜¸ì…ë‹ˆë‹¤. 1ê³¼ 65535 ì‚¬ì´ì˜ ê°’ì„ ì…ë ¥í•˜ì„¸ìš”.\n";
        return 1;
    }

    // ì…ë ¥ ë²„í¼ í´ë¦¬ì–´ (í¬íŠ¸ ì…ë ¥ í›„ ë‚¨ì€ ê°œí–‰ ì œê±°)
    std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');

    // ì†Œì¼“ ìƒì„±
    int client_socket = socket(AF_INET, SOCK_STREAM, 0);
    if (client_socket == -1)
    {
        std::cerr << "ì†Œì¼“ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n";
        return 1;
    }

    // ì„œë²„ ì£¼ì†Œ ì„¤ì •
    sockaddr_in server_addr{};
    server_addr.sin_family = AF_INET;
    server_addr.sin_port = htons(port);

    if (inet_pton(AF_INET, SERVER_IP, &server_addr.sin_addr) <= 0)
    {
        std::cerr << "ìœ íš¨í•˜ì§€ ì•Šì€ ì£¼ì†Œì…ë‹ˆë‹¤.\n";
        return 1;
    }

    // ì„œë²„ì— ì—°ê²°
    if (connect(client_socket, (sockaddr *)&server_addr, sizeof(server_addr)) < 0)
    {
        std::cerr << "ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n";
        return 1;
    }
    std::cout << "ì„œë²„ì— ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤.\n";

    bool inputMode = false;
    bool sqlMode = true;

    std::vector<Card> cards; // Card ê°ì²´ë¥¼ ì €ì¥í•  ë²¡í„°
    std::string user_input;

    // ë©”ì‹œì§€ ì†¡ìˆ˜ì‹  ë£¨í”„
    while (true)
    {
        /* 0. ì¹´ë“œ í´ë˜ìŠ¤ ìƒì„± ë° ë°ì´í„° ê°€ì ¸ì˜¤ê¸° */
        while (!inputMode && sqlMode)
        {
            char sqlBuffer[10000]; // recvë¥¼ ìœ„í•œ ë²„í¼

            // ì¹´ë“œì‚¬ ëª©ë¡
            std::vector<std::string> card_companies = {"KBêµ­ë¯¼ì¹´ë“œ", "ì‹ í•œì¹´ë“œ", "ìš°ë¦¬ì¹´ë“œ", "í•˜ë‚˜ì¹´ë“œ", "ë¡¯ë°ì¹´ë“œ", "ì‚¼ì„±ì¹´ë“œ"};

            for (const auto &company : card_companies)
            {
                // ì¿¼ë¦¬ ë¬¸ìì—´ ìƒì„±
                std::string modified_message = "query:SELECT name AS 'ì¹´ë“œëª…', corp_name AS 'ì¹´ë“œì‚¬', annual AS 'ì—°íšŒë¹„', month AS 'ì „ì›”ì‹¤ì ', "
                                               "bene1_type AS 'í˜œíƒ1', bene1 AS 'í˜œíƒ1 ìƒì„¸', bene2_type AS 'í˜œíƒ2', bene2 AS 'í˜œíƒ2 ìƒì„¸' "
                                               "FROM card_project.Card WHERE corp_name = '" +
                                               company + "'";

                // ì„œë²„ì— ì¿¼ë¦¬ ì „ì†¡
                send(client_socket, modified_message.c_str(), modified_message.length(), 0);

                // ì„œë²„ì—ì„œ ì‘ë‹µ ìˆ˜ì‹ 
                ssize_t bytes_received = recv(client_socket, sqlBuffer, sizeof(sqlBuffer) - 1, 0);
                if (bytes_received <= 0)
                {
                    std::cerr << "ì„œë²„ê°€ ì—°ê²°ì„ ëŠì—ˆê±°ë‚˜ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n";
                    break;
                }

                sqlBuffer[bytes_received] = '\0'; // ë¬¸ìì—´ ì¢…ë£Œ ì¶”ê°€

                // ë¬¸ìì—´ ìŠ¤íŠ¸ë¦¼ì„ ì‚¬ìš©í•´ í•œ ì¤„ì”© ë°ì´í„°ë¥¼ ì½ê³  ì²˜ë¦¬
                std::stringstream ss(sqlBuffer);
                std::string line;

                while (std::getline(ss, line))
                {
                    if (!line.empty())
                    {
                        std::vector<std::string> parts = split(line, '_');
                        if (parts.size() == 8)
                        {
                            Card card(parts[0], parts[1], parts[2], parts[3], parts[4], parts[5], parts[6], parts[7]);
                            cards.push_back(card);
                        }
                    }
                }
            }

            // ëª¨ë“  Card ê°ì²´ì˜ ì •ë³´ ì¶œë ¥
            for (const auto &card : cards)
            {
                card.printCardInfo();
            }

            sqlMode = false; // sqlMode ì¢…ë£Œ
        }

        /* 1. ë©”ì¸ í™”ë©´ */
        while (!inputMode && !sqlMode)
        {
            // 1-1. ì¸íŠ¸ë¡œ í™”ë©´
            system("clear");

            std::cout << "â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â£¤â£¤â£¤â£„â¡€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €\n";
            std::cout << "â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ˜â¡·â¡µâ£³â¢â¡Ÿâ¡·â£¦â¡€â €â €â €â¢€â£ â¡´â¡´â£¦â¢¶â£´â£¤â¡€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €\n";
            std::cout << "â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ˆâ ›â¢¼â¡«â£â¢½â£ªâ¡»â£§â¢”â£¼â£«â¡³â£â¢â¡µâ£³â¢µâ£â ‡â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €\n";
            std::cout << "â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ˆâ ˆâ â â¢â¡•â¢­â €â ‘â ™â Šâ ‹â Šâ ‘â â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €\n";
            std::cout << "â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â €â „â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â£ â â €â ¸â¡‚â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €\n";
            std::cout << "â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â£°â¢³â¡¹â£«â¢³â£„â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â£€â£€â¡€â¢ â â â €â €â ˆâ¢§â €â €â €â €â €â €â €â €â €â €â  â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €\n";
            std::cout << "â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢¸â¡•â¡•â ¥â¡¨â¢£â¡â£µâ¡€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢ â£Ÿâ¡½â£¹â¡«â£Ÿâ¢„â €â €â €â¢€â¡¼â¡¦â£†â¢„â €â €â €â €â €â €â €â €â ‘â¡„â €â €â €â¡€â â €â €â €â €â €â €â €â¢€â €â¡€â¢€â €â €â €â €â €â €â €â €â €â €â €â €â €\n";
            std::cout << "â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¡³â£â Œâ¡†â ‘â¡¢â¢šâ¢´â¢â¡¤â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢¹â£®â¢³â¡â£®â¢³â¡â €â €â €â£¾â£«â¢â¡®â£³â£…â €â €â €â €â €â €â €â €â¡½â£’â¢—â Šâ €â£€â¡ â °â ”â œâ ’â ‹â ‹â «â «â£â¢­â¡«â¡³â¡²â£„â¡€â €â €â €â €â €â €â €â €\n";
            std::cout << "â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢¨â¡³â¡•â¢Œâ ªâ¢€â ˆâ¢†â ±â¡±â£â¢¦â£€â¢†â¡”â£¤â¢¢â¡¢â¡²â¡”â¡¦â£¢â¡€â €â €â €â €â €â €â ™â ®â ³â â Šâ €â €â €â €â »â£®â¡³â£â¢®â¡â €â €â €â €â €â €â¡ â Šâ ƒâ ™â¢¦â €â ˆâ €â €â €â €â €â €â €â €â €â €â €â ˆâ ªâ¢â¢®â¡ªâ£³â¢„â €â €â €â €â €â €â €\n";
            std::cout << "â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â£â¢œâ •â¡Œâ¢‚â €â ‚â „â ‘â¡”â ±â •â µâ¡™â¢â¢â £â£‹â šâ¡œâ ªâ£â¢½â¡€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â â ›â ˜â â €â €â €â €â €â €â â €â €â €â €â €â ¡â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ˆâ£—â¢µâ¡±â¢§â €â €â €â €â €â €â €\n";
            std::cout << "â €â €â €â €â €â €â €â €â €â €â €â¡€â¢ â£€â¢¦â¢¬â¡šâ¡®â¡£â¢â¢Œâ¡Šâ  â ˆâ „â ˆâ „â¡ˆâ ‘â¡‰â Šâ œâ¢€â ƒâ ‘â¡ˆâ¢ˆâ Šâ ’â ˜â ªâ ‚â €â €â¡â£ â¡‚â „â €â €â €â €â¡â£ â¡‚â „â €â €â¢€â €â¡€â €â €â €â €â¢€â €â €â €â €â €â €â €â €â â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢®â¡ªâ¡ºâ¡•â €â €â €â €â €â €â €\n";
            std::cout << "â €â €â €â €â €â €â €â €â¢€â¢¢â¢â¢â¢µâ ±â¡£â¢£â¢™â¢Œâ ¢â¡‘â ‚â¢â£€â¡â£ˆâ¢â €â¡â  â¡€â¢â ‚â „â¢¨â¢—â¢â¢â¢â¡«â£›â †â â£ â¡¢â£°â¢£â ¯â£¤â£¨â¡€â¢‚â¡”â¡¤â¡³â£â¢„â£¢â €â „â¢¶â¢¦â â €â¡€â¢±â ´â¡„â¢â €â „â¡â¢€â €â¡‚â  â €â¡€â¢‚â¢â¢€â¢‚â¡â¢€â €â¡â €â „â €â¢€â¡—â£â¢¼â â €â €â €â €â €â €â €\n";
            std::cout << "â €â €â €â €â €â €â €â €â¢¸â££â¡‹â¡ªâ ¢â¡±â ˆâ ‚â ¡â €â ‚â „â â ½â£Œâ¢¯â¡ªâ£«â¢»â €â¢¼â¡¹â¡…â â¡€â¢¨â¡³â£â €â ¢â  â¢€â €â ‚â ˜â¡¸â£•â ³â£“â¢–â¡‘â¢â ˜â Šâ£ºâ¢ªâ¢â¡ƒâ ‹â£¢â¢Œâ¡—â£µâ €â¡±â¡´â£œâ¢â¢®â ´â£„â¢¸â£™â¡‡â£¸â¢»â „â¢€â ˜â ¯â ¹â â£§â¢«â¡ƒâ¢â¡â£Ÿâ €â €â¡¼â¡ªâ£â ƒâ €â €â €â €â €â €â €â €\n";
            std::cout << "â €â €â €â €â €â €â €â €â ˜â¢¦â¡³â£Œâ¡ªâ¢¢â¢‘â¢Œâ  â â Œâ  â â¡¤â¡¤â¡¤â¡”â¢§â¡»â¡€â¢¸â¢â¢—â¡â †â â¢§â¢â¢â¢â¢â •â ‡â ˆâ¢´â¢«â â¢â ˆâ ³â¡¹â¡†â €â¡µâ££â¡“â ©â£›â¢¦â¡‘â ‘â£â¢¼â €â¡ˆâ¢Šâ¡®â¡³â£‘â ‰â£¢â¢œâ¢®â †â¢¼â¡±â¡ƒâ €â£²â ²â¡–â¢¶â¡±â£â †â¢â¡â£®â €â¡¼â££â «â ‚â €â €â €â €â €â €â €â €â €\n";
            std::cout << "â €â €â €â €â €â €â €â €â €â €â ™â ¬â¡³â¡•â¢§â£Šâ ªâ¡¢â¢Œâ¡â €â šâ ˜â Šâ šâ¡µâ£¹â €â¢¸â¡£â¡‡â  â ˆâ¢ â ¦â¡¤â¢¦â ¤â¡¦â£”â¡Œâ  â¢ â¡•â¡´â¡”â¡´â£”â¢¬â¡„â €â ™â ‚â „â €â¢ˆâ¢‘â£¤â €â¡‘â ‰â „â¢ â¢â¢®â “â¢â¢µâ¡Œâ¢‘â¢—â¡‡â¢¸â¢â ‡â €â£â¢®â¡£â¡´â¡¤â£¤â¡‚â  â£â¢¾â €â¡¯â Šâ €â €â €â €â €â €â €â €â €â €â €\n";
            std::cout << "â €â €â €â €â €â €â €â €â €â €â €â €â €â ‰â šâ¢œâ¡³â¡ªâ¡†â¢•â ˆâ „â ¡â ˆâ „â ™â ˆâ „â¡€â¢‰â  â €â ¡â ˆâ¢ƒâ ™â ˜â ‘â ‘â ˆâ Šâ €â ˆâ Šâ Šâ£ºâ ªâ Šâ Šâ ‚â ˆâ €â €â €â €â €â °â¡³â ¦â¡¦â â €â €â ‰â ‚â €â €â ‘â â €â â â ˆâ â â €â ˜â¢€â ‰â Šâ ˜â €â¡â¢€â£…â£¡â â â €â €â €â €â €â €â €â €â €â €â €â €\n";
            std::cout << "â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢¹â¡ªâ¡â¢ªâ ‚â¡ˆâ „â ¡â ˆâ¢„â ¡â¡‚â¢”â  â¡€â ¡â €â ¡â¢ˆâ¢â ¹â¡«â£â €â €â €â €â €â €â ‘â ‰â €â €â €â €â €â €â €â €â €â ‚â â €â €â ‚â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â¡´â¡«â Šâ €â €â €â €â €â €â €â €â €â €â €â €â €â €â €\n";
            std::cout << "â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ¸â£œâ¡•â¡¡â ƒâ „â ˆâ¢„â ±â¡ˆâ£â¢œâ£”â¢…â £â¡Šâ¢†â ¥â¡€â¢Œâ¡Šâ¢ºâ¢œâ£‡â €â €â¡€â¢€â €â¡€â¢€â €â „â¡€â¢€â €â¢¢â â¡€â¢€â €â¡€â¢€â ‚â¡†â¢€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â£ â¢œâ •â â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €\n";
            std::cout << "â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ¨â¡®â£ªâ ¨â¡ƒâ¢ˆâ¢”â ¡â¡£â¡â£œâ •â µâ¢©â¢â¢â¢¦â¡£â¡ªâ¡¢â¡‘â¢…â¡§â£â €â €â£¸â ‘â¡¹â£¸â ‘â ™â£œâ ˆâ¡—â €â¡³â£¸â¢‘â —â¡œâ ‘â¡â¢¹â¡‘â¢â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â¡”â ®â â â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €\n";
            std::cout << "â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â â¡¯â£ªâ ¢â¡‘â¡…â£ªâ ºâ£•â â €â €â €â €â ˆâ â ƒâ ¹â¢ªâ¢â¢â¢—â¡•â ƒâ €â €â¡®â ‰â â Šâ €â €â ‰â ‰â ‰â ‰â â ˆâ ‘â â ™â ‰â â ˆâ ‰â ‚â €â €â €â €â €â €â €â €â €â €â €â£€â¢”â œâ ‰â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €\n";
            std::cout << "â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢«â¡ºâ£¢â¢•â¢®â¡£â ›â €â €â €â €â €â €â €â €â €â €â €â €â â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â¡ â ‚â Šâ €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €\n";
            std::cout << "â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ‘â ‘â ƒâ ƒâ â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ˆâ €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €\n";
            // std::cin.get()ì„ ì‚¬ìš©í•˜ì—¬ ì•„ë¬´ í‚¤ë‚˜ ì…ë ¥ ë°›ê¸°
            std::cout << "ì¹´ë“œ ì¶”ì²œ ì²´ë¦¬ ì„œë¹„ìŠ¤ì— ì˜¤ì‹ ê±¸ í™˜ì˜í•©ë‹ˆë‹¤.\n";
            std::cout << "ê³„ì†í•˜ë ¤ë©´ ì•„ë¬´ í‚¤ë‚˜ ëˆ„ë¥´ì„¸ìš”.";

            std::cin.get(); // ì‚¬ìš©ìë¡œë¶€í„° ì•„ë¬´ í‚¤ë‚˜ ì…ë ¥ë°›ìŒ

            system("clear");

            // 1-2.ë©”ë‰´ ì„ íƒ í™”ë©´
            char buffer[BUF_SIZE];
            bool menu = true;
            int menuIdx = 0; // 0 : ë©”ë‰´ ì„ íƒ, 1 : ì¹´ë“œ ê²€ìƒ‰, 2: ì¹´ë“œ ì¶”ì²œ
            std::set<std::string> valid_inputs;
            while (menu)
            {
                std::string result;  // ì‚¬ìš©ìê°€ ì„ íƒí•œ í˜œíƒ
                while (menuIdx == 0) // ë©”ë‰´ ì„ íƒ
                {
                    system("clear");

                    valid_inputs = {"ê²€ìƒ‰", "ì¹´ë“œ ê²€ìƒ‰", "ì¹´ë“œê²€ìƒ‰", "1", "ì¶”ì²œ", "ì¹´ë“œ ì¶”ì²œ", "ì¹´ë“œì¶”ì²œ", "2"}; // ìœ íš¨í•œ ì…ë ¥ê°’ì„ ëª¨ì•„ë†“ì€ set

                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“\t";
                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“\n";

                    std::cout << "â”ƒ                                      â”ƒ\t";
                    std::cout << "â”ƒ                                      â”ƒ\n";

                    std::cout << "â”ƒ        ë§ì¶¤ í˜œíƒìœ¼ë¡œ ì§ì ‘ ì°¾ê¸°       â”ƒ\t";
                    std::cout << "â”ƒ        1ë¶„ í…ŒìŠ¤íŠ¸ë¡œ ì¶”ì²œ ë°›ê¸°        â”ƒ\n";

                    std::cout << "â”ƒ            ğŸ” ì¹´ë“œ ê²€ìƒ‰              â”ƒ\t";
                    std::cout << "â”ƒ         ğŸ“± ì¹´ë“œì¶”ì²œ í…ŒìŠ¤íŠ¸           â”ƒ\n";

                    std::cout << "â”ƒ                                      â”ƒ\t";
                    std::cout << "â”ƒ                                      â”ƒ\n";

                    std::cout << "â”ƒ        [1.ë§ì¶¤ ì¹´ë“œ ë°”ë¡œê°€ê¸°]        â”ƒ\t";
                    std::cout << "â”ƒ     [2.ì¹´ë“œì¶”ì²œ í…ŒìŠ¤íŠ¸ ë°”ë¡œê°€ê¸°]     â”ƒ\n";

                    std::cout << "â”ƒ                                      â”ƒ\t";
                    std::cout << "â”ƒ                                      â”ƒ\n";

                    // í•˜ë‹¨ ë¼ì¸
                    std::cout << "â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›\t";
                    std::cout << "â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›\n";

                    while (true)
                    {
                        std::cout << "ë©”ë‰´ë¥¼ ì„ íƒí•˜ì„¸ìš” : ";
                        std::getline(std::cin, user_input); // ì‚¬ìš©ì ì…ë ¥ ë°›ê¸°

                        if (valid_inputs.find(user_input) != valid_inputs.end())
                        {
                            if (user_input == "1" || user_input == "ê²€ìƒ‰" || user_input == "ì¹´ë“œ ê²€ìƒ‰" || user_input == "ì¹´ë“œê²€ìƒ‰")
                            {
                                menuIdx = 1;
                                break;
                            }
                            else if (user_input == "2" || user_input == "ì¶”ì²œ" || user_input == "ì¹´ë“œ ì¶”ì²œ" || user_input == "ì¹´ë“œì¶”ì²œ")
                            {
                                menuIdx = 2;
                                break;
                            }
                        }
                        else // ìœ íš¨í•˜ì§€ ì•Šì€ ì…ë ¥ì´ë©´ ë‹¤ì‹œ ìš”ì²­
                        {
                            std::cout << "ì˜ëª»ëœ ì…ë ¥ì…ë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”." << std::endl;
                            continue;
                        }
                    }
                }
                while (menuIdx == 1)
                {
                    system("clear");

                    std::vector<std::string> userSelectedBenefits; // ì‚¬ìš©ìê°€ ì„ íƒí•œ í˜œíƒ ë¦¬ìŠ¤íŠ¸

                    /*  ìœ íš¨í•œ ì…ë ¥ê°’ì„ ëª¨ì•„ë†“ì€ set */
                    valid_inputs = {"ëŒ€ì¤‘êµí†µ", "êµí†µ", "ì‡¼í•‘", "ì™¸ì‹", "ì˜ë£Œ", "ì£¼ìœ ", "í†µì‹ ",
                                    "1", "2", "3", "4", "5", "6", "back"};

                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“\t";
                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“\t";
                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“\n";
                    std::cout << "â”ƒ        1.ëŒ€ì¤‘êµí†µ        â”ƒ\t";
                    std::cout << "â”ƒ        2. ì‡¼í•‘           â”ƒ\t";
                    std::cout << "â”ƒ        3. ì™¸ì‹           â”ƒ\n";
                    std::cout << "â”ƒ            ğŸšŒ            â”ƒ\t";
                    std::cout << "â”ƒ            ğŸ›ï¸             â”ƒ\t";
                    std::cout << "â”ƒ            ğŸ½ï¸             â”ƒ\n";
                    std::cout << "â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›\t";
                    std::cout << "â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›\t";
                    std::cout << "â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›\n\n";
                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“\t";
                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“\t";
                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“\n";
                    std::cout << "â”ƒ        4. ì˜ë£Œ           â”ƒ\t";
                    std::cout << "â”ƒ        5. ì£¼ìœ            â”ƒ\t";
                    std::cout << "â”ƒ        6. í†µì‹            â”ƒ\n";
                    std::cout << "â”ƒ            ğŸ¥            â”ƒ\t";
                    std::cout << "â”ƒ            â›½            â”ƒ\t";
                    std::cout << "â”ƒ            ğŸ“            â”ƒ\n";
                    std::cout << "â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›\t";
                    std::cout << "â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›\t";
                    std::cout << "â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›\n";
                    std::cout << "ì´ì „ ë©”ë‰´ë¡œ ëŒì•„ê°€ê¸° : 'back' ì…ë ¥\n";

                    // ì„ í˜¸ í˜œíƒ ì„ íƒ
                    while (menuIdx == 1)
                    {
                        std::cout << "ì„ í˜¸í•˜ì‹œëŠ” í˜œíƒì„ ì„ íƒí•˜ì„¸ìš” : ";
                        std::getline(std::cin, user_input); // ì‚¬ìš©ì ì…ë ¥ ë°›ê¸°

                        if (valid_inputs.find(user_input) != valid_inputs.end())
                        {
                            // ìœ íš¨í•œ ì…ë ¥ì´ë©´ ëŒ€ì‘í•˜ëŠ” ê²°ê³¼ë¥¼ ì„¤ì •í•˜ê³  ë°˜ë³µ ì¢…ë£Œ
                            if (user_input == "ëŒ€ì¤‘êµí†µ" || user_input == "êµí†µ" || user_input == "1")
                            {
                                result = "ëŒ€ì¤‘êµí†µ";
                                break;
                            }
                            else if (user_input == "2" || user_input == "ì‡¼í•‘")
                            {
                                result = "ì‡¼í•‘";
                                break;
                            }
                            else if (user_input == "3" || user_input == "ì™¸ì‹")
                            {
                                result = "ì™¸ì‹";
                                break;
                            }
                            else if (user_input == "4" || user_input == "ì˜ë£Œ")
                            {
                                result = "ì˜ë£Œ";
                                break;
                            }
                            else if (user_input == "5" || user_input == "ì£¼ìœ ")
                            {
                                result = "ì£¼ìœ ";
                                break;
                            }
                            else if (user_input == "6" || user_input == "í†µì‹ ")
                            {
                                result = "í†µì‹ ";
                                break;
                            }
                            else if (user_input == "back")
                            {
                                menuIdx = 0;
                                break;
                            }
                        }
                        else // ìœ íš¨í•˜ì§€ ì•Šì€ ì…ë ¥ì´ë©´ ë‹¤ì‹œ ìš”ì²­
                        {
                            std::cout << "ì˜ëª»ëœ ì…ë ¥ì…ë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”." << std::endl;
                            continue;
                        }
                    }

                    // ì„ í˜¸ í˜œíƒ ê²°ê³¼ ì¶œë ¥
                    while (menuIdx == 1)
                    {
                        system("clear");
                        userSelectedBenefits.push_back(result); // ì‚¬ìš©ìê°€ ì…ë ¥í•œ í˜œíƒì„ ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€

                        for (const auto &card : cards)
                        {
                            if (card.isBenefitMatch(userSelectedBenefits))
                            {
                                card.printCardInfo();
                            }
                        }

                        std::cout << "\në‹¤ë¥¸ í˜œíƒì„ ì„ íƒí•˜ì‹œë ¤ë©´ 'back', ë©”ì¸ ë©”ë‰´ë¡œ ëŒì•„ê°€ì‹œë ¤ë©´ 'main'ì„ ì…ë ¥í•˜ì„¸ìš”.\n>>";
                        std::cin >> user_input;
                        std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');

                        if (user_input == "back")
                        {
                            break; // ì…ë ¥ì„ ëë‚´ê¸° ìœ„í•´ 'ë'ì„ ì…ë ¥
                        }
                        else if (user_input == "main")
                        {
                            menuIdx = 0;
                            break; // ì…ë ¥ì„ ëë‚´ê¸° ìœ„í•´ 'ë'ì„ ì…ë ¥
                        }
                    }
                }
                while (menuIdx == 2)
                {
                    std::vector<std::string> userSelectedBenefits; // ì‚¬ìš©ìê°€ ì„ íƒí•œ í˜œíƒ ë¦¬ìŠ¤íŠ¸

                    // ê° í˜œíƒì˜ ì ìˆ˜ë¥¼ ì €ì¥í•  ë³€ìˆ˜ ì´ˆê¸°í™”
                    map<string, int> benefitScores = {
                        {"commute", 0},  // êµí†µ
                        {"shopping", 0}, // ì‡¼í•‘
                        {"dining", 0},   // ì™¸ì‹
                        {"medical", 0},  // ì˜ë£Œ
                        {"fuel", 0},     // ì£¼ìœ 
                        {"telecom", 0}   // í†µì‹ 
                    };

                    int answer;

                    system("clear");
                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
                    std::cout << "01/18" << " â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ " << "5.6%\n";
                    cout << "\nğŸ’  ìš´ì „ì„ ë§ì´ í•˜ì‹œë‚˜ìš”?\n    (1. YES  2. NO) >> ";
                    answer = getValidInput();
                    if (answer == 1)
                    {
                        benefitScores["commute"]++;
                    }

                    system("clear");
                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
                    std::cout << "02/18" << " â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ " << "11.1%\n";
                    cout << "\nğŸ’  ì™¸ì‹ì„ ìì£¼ í•˜ì‹œë‚˜ìš”?\n    (1. YES  2. NO) >> ";
                    answer = getValidInput();
                    if (answer == 1)
                    {
                        benefitScores["dining"]++;
                    }

                    system("clear");
                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
                    std::cout << "03/18" << " â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ " << "16.7%\n";
                    cout << "\nğŸ’  ëŒ€ì¤‘êµí†µì„ ìì£¼ ì´ìš©í•˜ì‹œë‚˜ìš”?\n    (1. YES  2. NO) >> ";
                    answer = getValidInput();
                    if (answer == 1)
                    {
                        benefitScores["commute"]++;
                    }

                    system("clear");
                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
                    std::cout << "04/18" << " â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ " << "22.2%\n";
                    cout << "\nğŸ’  ê³ ì†ë„ë¡œë¥¼ ê°ˆ ì¼ì´ ë§ìœ¼ì‹ ê°€ìš”?\n    (1. YES  2. NO) >> ";
                    answer = getValidInput();
                    if (answer == 1)
                    {
                        benefitScores["commute"]++;
                    }

                    system("clear");
                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
                    std::cout << "05/18" << " â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ " << "27.8%\n";
                    cout << "\nğŸ’  í•¸ë“œí° ìš”ê¸ˆ ë¶€ë‹´ì´ í¬ì‹ ê°€ìš”?\n    (1. YES  2. NO) >> ";
                    answer = getValidInput();
                    if (answer == 1)
                    {
                        benefitScores["telecom"]++;
                    }

                    system("clear");
                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
                    std::cout << "06/18" << " â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ " << "33.3%\n";
                    cout << "\nğŸ’  ìŒì‹ ë°°ë‹¬ì„ ìì£¼ ì‹œí‚¤ì‹œë‚˜ìš”?\n    (1. YES  2. NO) >> ";
                    answer = getValidInput();
                    if (answer == 1)
                    {
                        benefitScores["dining"]++;
                    }

                    system("clear");
                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
                    std::cout << "07/18" << " â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ " << "38.9%\n";
                    cout << "\nğŸ’  ì£¼ìœ ë¹„ í• ì¸ì´ í•„ìš”í•˜ì‹ ê°€ìš”?\n    (1. YES  2. NO) >> ";
                    answer = getValidInput();
                    if (answer == 1)
                    {
                        benefitScores["fuel"]++;
                    }

                    system("clear");
                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
                    std::cout << "08/18" << " â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ " << "44.4%\n";
                    cout << "\nğŸ’  ì¹´í˜ë¥¼ ìì£¼ ê°€ì‹œë‚˜ìš”?\n    (1. YES  2. NO) >> ";
                    answer = getValidInput();
                    if (answer == 1)
                    {
                        benefitScores["dining"]++;
                    }

                    system("clear");
                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
                    std::cout << "09/18" << " â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ " << "50.0%\n";
                    cout << "\nğŸ’  ì¸í„°ë„· ë¹„ìš© í• ì¸ì´ í•„ìš”í•˜ì‹ ê°€ìš”?\n    (1. YES  2. NO) >> ";
                    answer = getValidInput();
                    if (answer == 1)
                    {
                        benefitScores["telecom"]++;
                    }

                    system("clear");
                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
                    std::cout << "10/18" << " â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ " << "55.6%\n";
                    cout << "\nğŸ’  ì‡¼í•‘ì„ ìì£¼ í•˜ì‹œë‚˜ìš”?\n    (1. YES  2. NO) >> ";
                    answer = getValidInput();
                    if (answer == 1)
                    {
                        benefitScores["shopping"]++;
                    }

                    system("clear");
                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
                    std::cout << "11/18" << " â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ " << "61.1%\n";
                    cout << "\nğŸ’  í†µì‹  ìš”ê¸ˆ í• ì¸ì´ í•„ìš”í•˜ì‹ ê°€ìš”?\n    (1. YES  2. NO) >> ";
                    answer = getValidInput();
                    if (answer == 1)
                    {
                        benefitScores["telecom"]++;
                    }

                    system("clear");
                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
                    std::cout << "12/18" << " â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ " << "66.7%\n";
                    cout << "\nğŸ’  ì˜¨ë¼ì¸ ì‡¼í•‘ì„ ë§ì´ ì´ìš©í•˜ì‹œë‚˜ìš”?\n    (1. YES  2. NO) >> ";
                    answer = getValidInput();
                    if (answer == 1)
                    {
                        benefitScores["shopping"]++;
                    }

                    system("clear");
                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
                    std::cout << "13/18" << " â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ " << "72.2%\n";
                    cout << "\nğŸ’  ë°±í™”ì  í• ì¸ í˜œíƒì´ í•„ìš”í•˜ì‹ ê°€ìš”?\n    (1. YES  2. NO) >> ";
                    answer = getValidInput();
                    if (answer == 1)
                    {
                        benefitScores["shopping"]++;
                    }

                    system("clear");
                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
                    std::cout << "14/18" << " â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ " << "77.8%\n";
                    cout << "\nğŸ’  ì£¼ê¸°ì ìœ¼ë¡œ ë³‘ì›ì— ë°©ë¬¸ í•˜ì‹œë‚˜ìš”?\n    (1. YES  2. NO) >> ";
                    answer = getValidInput();
                    if (answer == 1)
                    {
                        benefitScores["medical"]++;
                    }

                    system("clear");
                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
                    std::cout << "15/18" << " â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘ " << "83.3%\n";
                    cout << "\nğŸ’  ìë™ì°¨ ìœ ì§€ë¹„ ì ˆì•½ì´ í•„ìš”í•˜ì‹ ê°€ìš”?\n    (1. YES  2. NO) >> ";
                    answer = getValidInput();
                    if (answer == 1)
                    {
                        benefitScores["fuel"]++;
                    }

                    system("clear");
                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
                    std::cout << "16/18" << " â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ " << "88.9%\n";
                    cout << "\nğŸ’  í”¼ë¶€ì‹œìˆ ì— ê´€ì‹¬ì´ ë§ìœ¼ì‹œë‚˜ìš”?\n    (1. YES  2. NO) >> ";
                    answer = getValidInput();
                    if (answer == 1)
                    {
                        benefitScores["medical"]++;
                    }

                    system("clear");
                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
                    std::cout << "17/18" << " â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ " << "94.4%\n";
                    cout << "\nğŸ’  ê±´ê°•ê²€ì§„ ë¹„ìš©ì´ ë¶€ë‹´ë˜ì‹œë‚˜ìš”?\n    (1. YES  2. NO) >> ";
                    answer = getValidInput();
                    if (answer == 1)
                    {
                        benefitScores["medical"]++;
                    }

                    system("clear");
                    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
                    std::cout << "18/18" << " â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ " << "99.6%\n";
                    cout << "\nğŸ’  ì£¼ìœ ë¥¼ ìì£¼ í•˜ì‹œë‚˜ìš”?\n    (1. YES  2. NO) >> ";
                    answer = getValidInput();
                    if (answer == 1)
                    {
                        benefitScores["fuel"]++;
                    }

                    // 2. ì„±í–¥ ì ìˆ˜ë¥¼ ë²¡í„°ì— ë„£ê³  ì •ë ¬
                    vector<BenefitScore> scores;
                    for (auto &pair : benefitScores)
                    {
                        scores.push_back({pair.first, pair.second});
                    }
                    sort(scores.begin(), scores.end(), compareScores);

                    // 3. ê°€ì¥ ë†’ì€ ì„±í–¥ì— ë”°ë¼ ì¹´ë“œ ì¶”ì²œ
                    string selectedBenefit = scores[0].benefitType; // ê°€ì¥ ë†’ì€ ì„±í–¥ ì¶”ì¶œ
                    // std::cout << selectedBenefit;

                    // ìœ íš¨í•œ ì…ë ¥ì´ë©´ ëŒ€ì‘í•˜ëŠ” ê²°ê³¼ë¥¼ ì„¤ì •í•˜ê³  ë°˜ë³µ ì¢…ë£Œ
                    if (selectedBenefit == "commute")
                    {
                        result = "ëŒ€ì¤‘êµí†µ";
                    }
                    else if (selectedBenefit == "shopping")
                    {
                        result = "ì‡¼í•‘";
                    }
                    else if (selectedBenefit == "dining")
                    {
                        result = "ì™¸ì‹";
                    }
                    else if (selectedBenefit == "medical")
                    {
                        result = "ì˜ë£Œ";
                    }
                    else if (selectedBenefit == "fuel")
                    {
                        result = "ì£¼ìœ ";
                    }
                    else if (selectedBenefit == "telecom")
                    {
                        result = "í†µì‹ ";
                    }

                    system("clear");
                    userSelectedBenefits.push_back(result); // ì‚¬ìš©ìê°€ ì…ë ¥í•œ í˜œíƒì„ ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€

                    // TOP3 ì¶œë ¥
                    // "query:" ì ‘ë‘ì‚¬ ì¶”ê°€
                    std::string modified_message = "query:SELECT rb.card_name AS ì¹´ë“œëª…, rb.corp_name AS ì¹´ë“œì‚¬, c.annual AS ì—°íšŒë¹„, c.month AS ì „ì›”ì‹¤ì , c.bene1_type AS 'í˜œíƒ1', c.bene1 AS 'í˜œíƒ1 ìƒì„¸', c.bene2_type AS 'í˜œíƒ2', c.bene2 AS 'í˜œíƒ2 ìƒì„¸' FROM card_project.Rank_Benefit rb JOIN card_project.Card c ON rb.card_name = c.name WHERE rb.type = '" + result + "'";
                    send(client_socket, modified_message.c_str(), modified_message.length(), 0);
                    std::cout << std::endl;

                    ssize_t bytes_received = recv(client_socket, buffer, 10000, 0);
                    if (bytes_received <= 0)
                    {
                        std::cerr << "ì„œë²„ê°€ ì—°ê²°ì„ ëŠì—ˆê±°ë‚˜ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n";
                        break;
                    }

                    buffer[bytes_received] = '\0';
                    std::vector<Card> card_temp; // Card ê°ì²´ë¥¼ ì €ì¥í•  ë²¡í„°

                    // ë¬¸ìì—´ ìŠ¤íŠ¸ë¦¼ì„ ì‚¬ìš©í•´ í•œ ì¤„ì”© ë°ì´í„°ë¥¼ ì½ê³  ì²˜ë¦¬
                    std::stringstream ss(buffer);
                    std::string line;

                    while (std::getline(ss, line))
                    {
                        if (!line.empty())
                        {
                            std::vector<std::string> parts = split(line, '_');
                            // ë””ë²„ê¹…: lineê³¼ parts í¬ê¸° ì¶œë ¥
                            std::cout << "Processing line: " << line << std::endl;
                            std::cout << "Parts size: " << parts.size() << std::endl;

                            if (parts.size() == 8)
                            {
                                Card card1(parts[0], parts[1], parts[2], parts[3], parts[4], parts[5], parts[6], parts[7]);
                                card_temp.push_back(card1);
                            }
                            else
                            {
                                std::cout << "Warning: Unexpected number of parts (" << parts.size() << ") in line: " << line << std::endl;
                            }
                        }
                    }
                    system("clear");
                    std::cout << "ğŸ’ ê³ ê°ë‹˜ê»˜ " + result + " í˜œíƒì„ ì¶”ì²œë“œë ¤ìš”!\nğŸ’ " + result + " í˜œíƒì„ ì œê³µí•˜ëŠ” ì¹´ë“œì¤‘ì— ê°€ì¥ ì¸ê¸° ìˆëŠ” 3ê°œì˜ ì¹´ë“œë¥¼ ë³´ì—¬ë“œë¦´ê²Œìš”.\n\n";
                    // ëª¨ë“  Card ê°ì²´ì˜ ì •ë³´ ì¶œë ¥
                    for (const auto &card1 : card_temp)
                    {
                        card1.printCardInfo();
                    }

                    // ì„ í˜¸ í˜œíƒ ê²°ê³¼ ì¶œë ¥
                    while (menuIdx == 2)
                    {
                        std::cout << "\në‹¤ì‹œ í•˜ì‹œë ¤ë©´ 'back', ë©”ì¸ ë©”ë‰´ë¡œ ëŒì•„ê°€ì‹œë ¤ë©´ 'main'ì„ ì…ë ¥í•˜ì„¸ìš”.\n>>";
                        std::cin >> user_input;
                        std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');

                        if (user_input == "back")
                        {
                            break; // ì…ë ¥ì„ ëë‚´ê¸° ìœ„í•´ 'ë'ì„ ì…ë ¥
                        }
                        else if (user_input == "main")
                        {
                            menuIdx = 0;
                            break; // ì…ë ¥ì„ ëë‚´ê¸° ìœ„í•´ 'ë'ì„ ì…ë ¥
                        }
                    }
                }
                continue;
            }

            inputMode = true;
            menu = false;
        }

        /* ì¼ë°˜ ë©”ì‹œì§€ ì „ì†¡ ëª¨ë“œë¡œ ì „í™˜ */
        while (inputMode)
        {
            char buffer[BUF_SIZE];
            // system("clear");
            std::cout << "ì„œë²„ë¡œ ë³´ë‚¼ ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš” ('exit'ì„ ì…ë ¥í•˜ë©´ ì¢…ë£Œí•©ë‹ˆë‹¤): ";
            std::getline(std::cin, user_input);

            // ë¹ˆ ì…ë ¥ì— ëŒ€í•œ ì²˜ë¦¬: ì‚¬ìš©ìê°€ ì—”í„°ë§Œ ì…ë ¥í•˜ë©´ ë‹¤ì‹œ ì…ë ¥ ìš”êµ¬
            if (user_input.empty())
            {
                std::cout << "ì…ë ¥ ê°’ì´ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”.\n";
                continue; // ë£¨í”„ì˜ ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ ë‹¤ì‹œ ì…ë ¥ ë°›ìŒ
            }

            // 'exit' ì…ë ¥ ì‹œ ì¼ë°˜ ë©”ì‹œì§€ ëª¨ë“œ ì¢…ë£Œ
            if (user_input == "exit")
            {
                break; // ì¼ë°˜ ë©”ì‹œì§€ ëª¨ë“œ ì¢…ë£Œ
            }

            // ì¼ë°˜ ë©”ì‹œì§€ ì „ì†¡
            if (send(client_socket, user_input.c_str(), user_input.length(), 0) == -1)
            {
                std::cerr << "ë©”ì‹œì§€ ì „ì†¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n";
                return 1;
            }
            std::cout << "ë©”ì‹œì§€ë¥¼ ì „ì†¡í–ˆìŠµë‹ˆë‹¤: " << user_input << std::endl;

            // ì„œë²„ë¡œë¶€í„°ì˜ ì‘ë‹µ ìˆ˜ì‹ 
            ssize_t bytes_received = recv(client_socket, buffer, BUF_SIZE - 1, 0);
            if (bytes_received <= 0)
            {
                std::cerr << "ì„œë²„ê°€ ì—°ê²°ì„ ëŠì—ˆê±°ë‚˜ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n";
                return 1;
            }

            buffer[bytes_received] = '\0'; // ë°›ì€ ë°ì´í„°ë¥¼ ë¬¸ìì—´ë¡œ ë³€í™˜
            std::cout << "ì„œë²„ë¡œë¶€í„°: " << buffer << std::endl;
        }

        // ì—ëŸ¬ ì‹œ while ì¢…ë£Œ
        break;
    }

    // í´ë¼ì´ì–¸íŠ¸ ì†Œì¼“ ì¢…ë£Œ
    close(client_socket);
    return 0;
}
